
<!DOCTYPE html>
<html>

<?php
	/*DEFINE('DBUSER', 'root');
	DEFINE('DBPW', '');
	DEFINE ('DBSERVER', 'localhost');
	DEFINE ('DBNAME', 'bus');


	$link = mysql_connect(DBSERVER, DBUSER, DBPW);

	if(!$link){
		echo "Database connection failed!";
		echo mysql_error();
		exit();
	}

	if(!mysql_select_db(DBNAME, $link)){
		echo "Failed to select the database";
		echo mysql_error();
		exit();
	}*/

	//$query = "SELECT latitude, longitude FROM bus_location WHERE bus_id = 1";
	
	/*$SeatQuery = "SELECT A_seats FROM trip WHERE Trip_id =1";
	
	$s_result = mysql_query($SeatQuery, $link);
	$s_result = mysql_fetch_assoc($s_result);
	$seats = $s_result["A_seats"];

	$result = mysql_query($query, $link);

	$result = mysql_fetch_assoc($result);

	$latitude = $result["latitude"];
	$longitude = $result["longitude"];
	
	$coords = $latitude.",".$longitude;
	$myCoords;

	*/
	?>

<head>
	<link rel = "stylesheet" href = "jquery/jquery.mobile-1.4.4.min.css">
	<script src = "jquery/jquery-1.11.1.min.js"></script>
	<script src = "jquery/jquery.mobile-1.4.4.min.js"></script>
	<script src= "jquery/Barcode.js">

	<script src="http://maps.googleapis.com/maps/api/js?key=AIzaSyDY0kkJiTPVd2U7aTOAwhc9ySH6oHxOIYM&sensor=false">
	</script>

	<script src="http://maps.googleapis.com/maps/api/js?key=AIzaSyDY0kkJiTPVd2U7aTOAwhc9ySH6oHxOIYM&sensor=false">
	</script>

	<script>
	function initialize()
	{	
		var mapProp = {
			center:new google.maps.LatLng(5.7595729,-0.2201503),
			zoom:8,
			mapTypeId:google.maps.MapTypeId.ROADMAP
		};
		var map=new google.maps.Map(document.getElementById("googleMap")
			,mapProp);
	}

	google.maps.event.addDomListener(window, 'load', initialize);

	if(navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(function(position) {
      var pos = new google.maps.LatLng(position.coords.latitude,
       position.coords.longitude);

      //Store the person's location in the form
      var myLat = position.coords.latitude;
      var myLong = position.coords.longitude;

      var infowindow = new google.maps.InfoWindow({
        map: map,
        position: pos,
        content: 'Me'
      });

      var destLat = '<?php echo $destLat; ?>';
      var destLong = '<?php echo $destLong; ?>';
      var destName = '<?php echo $dest; ?>';
       map.setCenter(pos);
    }, function() {
      handleNoGeolocation(true);
    });

  } else {
    // Browser doesn't support Geolocation
    handleNoGeolocation(false);
  }

  	 
	</script>

	

	<script ="text/javascript">

	function syncAjax(m){
      console.log(m);
        var obj=$.ajax( {url:m, async:false } );
        console.log(obj.responseText);

        return $.parseJSON(obj.responseText);
        
      }


	$(document).ready(function(){
     //decrease the number of passengers;
      $("#clickReserve").click(function(){
       var P_name = document.getElementById('P_name').value;
     	var Passenger_id = document.getElementById('Passenger_id').value;
     	var pickUp = document.getElementById('drop').value;

     	document.getElementById('P_name').value = "";
     	document.getElementById('Passenger_id').value="";
     	document.getElementById('drop').value ="Select Bus stop";

                var m = "50.63.128.135/~csashesi/class2015/cecil-arthur/busApp/bus_gen.php?cmd=2&s="+P_name+"&l="+Passenger_id+"&c="+pickUp ;

           return syncAjax(m);
		

   
    });


    });




	</script>

<?php

	/*$myCoords = "SELECT latitude,longitude From passenger_location where passenger_id =1"; 
	$myCoords = mysql_query($myCoords, $link);
	$myCoords = mysql_fetch_assoc($myCoords);

	$latitude = $myCoords["latitude"];
	$longitude = $myCoords["longitude"];
	
	$myCoords = $latitude.",".$longitude;
	
	echo $myCoords;

*/


?>

<meta name="viewport" content="width-device-width, initial-scale=1">​


</head>


<body>
<script type="text/javascript">

						function writeBC(s)	{
    							var bc = new AtalasoftBarcode39(s);
    							document.getElementById('bcArea').innerHTML = bc.getBarcode(50, 2, 8);
							}
</script>
	


	<!--Page One-->
	<div data-role = "page" id = "pageone">
		<div data-role = "header">

			<h1> <img src="bus-icon.png" alt="bus icon" height="42" width="42"> Ashesi's Bus App </h1>

			<div data-role = "navbar">
				<ul>
					<li><a href = "#pageone" data-role = "button" data-icon = "home" data-iconpos="left" data-transition = "slide" class=" ui-btn-active ui-state-persist">Home</a></li>

					<li><a href = "#pagetwo" data-role = "button"  data-icon = "forward" data-transition = "slide">Reserve a seat</a></li>

				</ul>
			</div>


			<div>

				<h2> More info about Bus: </h2>
				<ol data-role ="listview">
					<li><a href = "https://maps.google.com/maps/?q=5.5675700,-0.1819970" data-role = "button" id="bus"> Bus locator </a></li> 

					<li><a href = "https://maps.google.com/maps/?saddr=5.5675700,-0.1819970&daddr=5.7595660,
-0.2201020"> Directions to Bus </a> </li>
				</ol> 
			</div>

		</div>

		<div data-role = "main" class = "ui-content">

			<p>This website is the web version of the Bus application developed by Cecil </p>

			<div data-role= "collapsible">
				<h1>Buss route </h1>
				<p>37 military Hospital  </p>
				<p> Airport first </p>
				<p>Accra Mall </p>
				<p>Legon </p>
			</div>
		</div>


		<div>
			<h2> Reserve a Seat  </h2> 
			             
			
			<ol data-role ="listview">
				<li><a href = "#pagetwo" data-role = "button" > Purchase Seat </a></li>
			</ol>	
		</div>		

		

		<div data-role = "footer">
			Work by  Cecil Arthur
		</div>
	</div>



	<!--Page Two-->

	<div data-role = "page" id = "pagetwo">
		<div data-role = "header">
			<div data-role = "navbar">
				<ul>
					<li>Keep calm and Reserve a Seat </li>
					
					
					<li><a href = "#" data-transition = "pop" data-role = "button" data-rel = "back">Back</a></li>
				</ul>
			</div>
		</div>

		<div>
		</br>
		<form >

			<div data-role="fieldcontain">
				<label >Passenger name: </label>
				<input type="text" name ="P_name" id= "P_name">  </input>

				 <label >Passenger Id: </label>
				<input type="text" name ="Passenger_id" id="Passenger_id">  </input>

				<label >Select Pick-up location </label>
				<select name="DropDown" id="drop">
					<option value=" ">Select Bus stop</option>
					<option value="37">37</option>
					<option value="Airport First">Airport 1st</option>
					<option value="Accra Mall">Accra Mall</option>
					<option value="Oponglo">Oponglo</option>
					<option value="Atomic Junction">Atomic</option>
					<option value="Abom">Abom</option>
					<option value="Kwabenya">Kwabenya</option>
					<option value="Comet">Comet</option>
				</select>	

					

			</div>
			
			<div data-role="fieldcontain">	
					
					<input type="submit" id="clickReserve" value="submit" name="submit" onclick="writeBC(document.getElementById('Passenger_id').value)"  >
					
					<div id="bcArea" ></div>

			</div>	
			

		</form>
	</div>

</div>
</div>








</body>
</html>

